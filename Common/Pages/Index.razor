@page "/"
@inject AppData appData

<PageTitle>Boards</PageTitle>

<div class="boards">
    @foreach (var index in appData.blazorBoardData.Boards.Select((e, i) => i))
    {
        <TaskBoard @bind-BoardData="appData.blazorBoardData.Boards[index]"
                   dragHelper="@dragHelper"
                   globalDragStart="@( task => dragHelper.dragStart(appData.blazorBoardData.Boards[index], task) )"
                   globalDragDrop="@( e => dragHelper.drop(appData.blazorBoardData.Boards[index], e.insertAtBoardPosition))"
                   globalDragEnd="@( e => dragHelper.dragEnd() )"
                   globalDragEnter="@( i => dragHelper.dragEnter(appData.blazorBoardData.Boards[index], i) )"
                   globalDragLeave="@( () => dragHelper.dragLeave() )" />
    }
    <Button class="add-board-button" Color="Color.Secondary" Outline><Icon Name="IconName.Add" @onclick="AddBoard" /> Add new board</Button>
</div>

@code {
    private DragHelper dragHelper = new();

    private void AddBoard()
    {
        appData.blazorBoardData.Boards.Add(new Board("Board"));
        StateHasChanged();
    }
}
